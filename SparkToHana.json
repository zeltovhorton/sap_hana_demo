{"paragraphs":[{"text":"%md\n## Federated SparkSQL using SAP HANA and HDP Hive ","dateUpdated":"2017-02-02T21:57:24+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486072577262_-684237453","id":"20170202-215617_264723714","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Federated SparkSQL using SAP HANA and HDP Hive</h2>\n"},"dateCreated":"2017-02-02T21:56:17+0000","dateStarted":"2017-02-02T21:57:19+0000","dateFinished":"2017-02-02T21:57:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:120"},{"text":"%spark\n\nval url=\"jdbc:sap://54.234.139.2:30015/?currentschema=XXX\"\n \nval prop = new java.util.Properties\nprop.setProperty(\"user\",\"\")\nprop.setProperty(\"password\",\"\")\nprop.setProperty(\"driver\",\"com.sap.db.jdbc.Driver\")\n\nval store_address = sqlContext.read.jdbc(url,\"STORE_ADDRESS\",prop) \nstore_address.registerTempTable(\"store_address\")","dateUpdated":"2017-02-02T22:29:10+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486071209953_1595838725","id":"20170202-213329_1510048663","result":{"code":"SUCCESS","type":"TEXT","msg":"url: String = jdbc:sap://54.234.139.2:30015/?currentschema=CODEJAMMER\nprop: java.util.Properties = {}\nres15: Object = null\nres16: Object = null\nres17: Object = null\nstore_address: org.apache.spark.sql.DataFrame = [ID: bigint, STREETNUMBER: int, STREET: string, LOCALITY: string, STATE: string, COUNTRY: string]\n"},"dateCreated":"2017-02-02T21:33:29+0000","dateStarted":"2017-02-02T21:52:25+0000","dateFinished":"2017-02-02T21:52:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:121"},{"text":"%spark\n\nval sales = sqlContext.sql(\"select storekey, productkey, salesamount from atlas_factsales limit 10\")\nsales.registerTempTable(\"sales\")","dateUpdated":"2017-02-02T21:54:02+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486071321921_-597122213","id":"20170202-213521_629744385","result":{"code":"SUCCESS","type":"TEXT","msg":"sales: org.apache.spark.sql.DataFrame = [storekey: int, productkey: int, salesamount: float]\n"},"dateCreated":"2017-02-02T21:35:21+0000","dateStarted":"2017-02-02T21:54:02+0000","dateFinished":"2017-02-02T21:54:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:122"},{"text":"%spark\n\nstore_address.show","dateUpdated":"2017-02-02T21:53:27+0000","config":{"colWidth":3,"graph":{"mode":"table","height":133,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486071252359_2028757858","id":"20170202-213412_1560176253","result":{"code":"SUCCESS","type":"TEXT","msg":"+---+------------+---------------+--------+-----+-------+\n| ID|STREETNUMBER|         STREET|LOCALITY|STATE|COUNTRY|\n+---+------------+---------------+--------+-----+-------+\n|  1|         555|    Madison Ave|New York|   NY|America|\n|  2|          95|  Morten Street|New York|   NY|    USA|\n|  3|        2395|Broadway Street|New York|   NY|    USA|\n+---+------------+---------------+--------+-----+-------+\n\n"},"dateCreated":"2017-02-02T21:34:12+0000","dateStarted":"2017-02-02T21:52:30+0000","dateFinished":"2017-02-02T21:52:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123"},{"text":"%sql\nselect * from store_address","dateUpdated":"2017-02-02T21:54:13+0000","config":{"colWidth":5,"graph":{"mode":"table","height":129,"optionOpen":false,"keys":[{"name":"ID","index":0,"aggr":"sum"}],"values":[{"name":"STREETNUMBER","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"ID","index":0,"aggr":"sum"},"yAxis":{"name":"STREETNUMBER","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486072355263_-1925977039","id":"20170202-215235_492743073","result":{"code":"SUCCESS","type":"TABLE","msg":"ID\tSTREETNUMBER\tSTREET\tLOCALITY\tSTATE\tCOUNTRY\n1\t555\tMadison Ave\tNew York\tNY\tAmerica\n2\t95\tMorten Street\tNew York\tNY\tUSA\n3\t2395\tBroadway Street\tNew York\tNY\tUSA\n","comment":"","msgTable":[[{"key":"STREETNUMBER","value":"1"},{"key":"STREETNUMBER","value":"555"},{"key":"STREETNUMBER","value":"Madison Ave"},{"key":"STREETNUMBER","value":"New York"},{"key":"STREETNUMBER","value":"NY"},{"key":"STREETNUMBER","value":"America"}],[{"key":"STREET","value":"2"},{"key":"STREET","value":"95"},{"key":"STREET","value":"Morten Street"},{"key":"STREET","value":"New York"},{"key":"STREET","value":"NY"},{"key":"STREET","value":"USA"}],[{"key":"LOCALITY","value":"3"},{"key":"LOCALITY","value":"2395"},{"key":"LOCALITY","value":"Broadway Street"},{"key":"LOCALITY","value":"New York"},{"key":"LOCALITY","value":"NY"},{"key":"LOCALITY","value":"USA"}]],"columnNames":[{"name":"ID","index":0,"aggr":"sum"},{"name":"STREETNUMBER","index":1,"aggr":"sum"},{"name":"STREET","index":2,"aggr":"sum"},{"name":"LOCALITY","index":3,"aggr":"sum"},{"name":"STATE","index":4,"aggr":"sum"},{"name":"COUNTRY","index":5,"aggr":"sum"}],"rows":[["1","555","Madison Ave","New York","NY","America"],["2","95","Morten Street","New York","NY","USA"],["3","2395","Broadway Street","New York","NY","USA"]]},"dateCreated":"2017-02-02T21:52:35+0000","dateStarted":"2017-02-02T21:53:06+0000","dateFinished":"2017-02-02T21:53:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:124"},{"text":"%sql\nselect * from sales limit 5\n\n","dateUpdated":"2017-02-02T21:55:39+0000","config":{"colWidth":4,"graph":{"mode":"table","height":157,"optionOpen":false,"keys":[{"name":"storekey","index":0,"aggr":"sum"}],"values":[{"name":"productkey","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"storekey","index":0,"aggr":"sum"},"yAxis":{"name":"productkey","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486071566721_-195876727","id":"20170202-213926_1484291220","result":{"code":"SUCCESS","type":"TABLE","msg":"storekey\tproductkey\tsalesamount\n254\t1880\t9594.0\n306\t160\t10999.9\n309\t1006\t2320.0\n244\t2493\t5997.6\n224\t48\t1199.6\n","comment":"","msgTable":[[{"key":"productkey","value":"254"},{"key":"productkey","value":"1880"},{"key":"productkey","value":"9594.0"}],[{"key":"salesamount","value":"306"},{"key":"salesamount","value":"160"},{"key":"salesamount","value":"10999.9"}],[{"value":"309"},{"value":"1006"},{"value":"2320.0"}],[{"value":"244"},{"value":"2493"},{"value":"5997.6"}],[{"value":"224"},{"value":"48"},{"value":"1199.6"}]],"columnNames":[{"name":"storekey","index":0,"aggr":"sum"},{"name":"productkey","index":1,"aggr":"sum"},{"name":"salesamount","index":2,"aggr":"sum"}],"rows":[["254","1880","9594.0"],["306","160","10999.9"],["309","1006","2320.0"],["244","2493","5997.6"],["224","48","1199.6"]]},"dateCreated":"2017-02-02T21:39:26+0000","dateStarted":"2017-02-02T21:55:26+0000","dateFinished":"2017-02-02T21:55:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:125"},{"text":"%spark\n\nsqlContext.sql(\"select s.salesamount, s.productkey, a.state, a.country from sales s inner join  store_address a where a.id in (1)\").show()","dateUpdated":"2017-02-02T22:04:04+0000","config":{"colWidth":4,"graph":{"mode":"table","height":204,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486072188507_1308612421","id":"20170202-214948_1430426157","result":{"code":"SUCCESS","type":"TEXT","msg":"+-----------+----------+-----+-------+\n|salesamount|productkey|state|country|\n+-----------+----------+-----+-------+\n|     307.26|       177|   NY|America|\n|     1490.0|      2180|   NY|America|\n|     2299.9|      2329|   NY|America|\n|    413.512|      1360|   NY|America|\n|     6990.0|       193|   NY|America|\n|    11184.3|      1412|   NY|America|\n|     1860.0|      1509|   NY|America|\n|     2120.4|       466|   NY|America|\n|     9090.0|      1889|   NY|America|\n|    254.526|         4|   NY|America|\n+-----------+----------+-----+-------+\n\n"},"dateCreated":"2017-02-02T21:49:48+0000","dateStarted":"2017-02-02T22:04:04+0000","dateFinished":"2017-02-02T22:04:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:126"},{"text":"%sql\nselect s.salesamount, s.productkey, a.state, a.country from sales s inner join  store_address a where a.id in (1) ","dateUpdated":"2017-02-02T22:04:07+0000","config":{"colWidth":7,"graph":{"mode":"table","height":319,"optionOpen":false,"keys":[{"name":"salesamount","index":0,"aggr":"sum"}],"values":[{"name":"productkey","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"salesamount","index":0,"aggr":"sum"},"yAxis":{"name":"productkey","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486072805306_403769496","id":"20170202-220005_1341695582","result":{"code":"SUCCESS","type":"TABLE","msg":"salesamount\tproductkey\tstate\tcountry\n9594.0\t1880\tNY\tAmerica\n10999.9\t160\tNY\tAmerica\n2320.0\t1006\tNY\tAmerica\n5997.6\t2493\tNY\tAmerica\n1199.6\t48\tNY\tAmerica\n11180.0\t445\tNY\tAmerica\n365.39\t860\tNY\tAmerica\n2741.2\t1433\tNY\tAmerica\n1160.0\t709\tNY\tAmerica\n1686.4\t730\tNY\tAmerica\n","comment":"","msgTable":[[{"key":"productkey","value":"9594.0"},{"key":"productkey","value":"1880"},{"key":"productkey","value":"NY"},{"key":"productkey","value":"America"}],[{"key":"state","value":"10999.9"},{"key":"state","value":"160"},{"key":"state","value":"NY"},{"key":"state","value":"America"}],[{"key":"country","value":"2320.0"},{"key":"country","value":"1006"},{"key":"country","value":"NY"},{"key":"country","value":"America"}],[{"value":"5997.6"},{"value":"2493"},{"value":"NY"},{"value":"America"}],[{"value":"1199.6"},{"value":"48"},{"value":"NY"},{"value":"America"}],[{"value":"11180.0"},{"value":"445"},{"value":"NY"},{"value":"America"}],[{"value":"365.39"},{"value":"860"},{"value":"NY"},{"value":"America"}],[{"value":"2741.2"},{"value":"1433"},{"value":"NY"},{"value":"America"}],[{"value":"1160.0"},{"value":"709"},{"value":"NY"},{"value":"America"}],[{"value":"1686.4"},{"value":"730"},{"value":"NY"},{"value":"America"}]],"columnNames":[{"name":"salesamount","index":0,"aggr":"sum"},{"name":"productkey","index":1,"aggr":"sum"},{"name":"state","index":2,"aggr":"sum"},{"name":"country","index":3,"aggr":"sum"}],"rows":[["9594.0","1880","NY","America"],["10999.9","160","NY","America"],["2320.0","1006","NY","America"],["5997.6","2493","NY","America"],["1199.6","48","NY","America"],["11180.0","445","NY","America"],["365.39","860","NY","America"],["2741.2","1433","NY","America"],["1160.0","709","NY","America"],["1686.4","730","NY","America"]]},"dateCreated":"2017-02-02T22:00:05+0000","dateStarted":"2017-02-02T22:04:08+0000","dateFinished":"2017-02-02T22:04:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:127"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486072943938_713659282","id":"20170202-220223_1661888420","dateCreated":"2017-02-02T22:02:23+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:128"}],"name":"/Hana/SparkToHana","id":"2CAVVF2KH","angularObjects":{"2C3N3W5W6:shared_process":[],"2C6RRCZQ4:shared_process":[],"2C5R46VED:shared_process":[],"2C3HXMGG8:shared_process":[],"2C4PQ3FEA:shared_process":[],"2C6M4A4JU:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}